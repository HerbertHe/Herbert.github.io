import{_ as s,c as n,o as a,a6 as e}from"./chunks/framework.DqpHdag1.js";const E=JSON.parse('{"title":"创建一个unified插件","description":"","frontmatter":{"title":"创建一个unified插件","date":"2024-03-23T21:56:45.000Z","toc":true,"tags":["unified","plugin","翻译","教程"]},"headers":[],"relativePath":"posts/zh/创建一个unified插件.md","filePath":"posts/zh/创建一个unified插件.md"}'),p={name:"posts/zh/创建一个unified插件.md"},l=e(`<blockquote><p>原文 <a href="https://unifiedjs.com/learn/guide/create-a-plugin/" target="_blank" rel="noreferrer">Creating a plugin with unified</a></p></blockquote><p>本教程展示了如何为 <a href="https://unifiedjs.com/explore/project/retextjs/retext/" target="_blank" rel="noreferrer">retext</a> 创建一个插件用于检测句子之间的空格数量。这里的概念也适用于 <a href="https://unifiedjs.com/explore/package/unified/" target="_blank" rel="noreferrer">unified</a> 的其他语法。</p><blockquote><p>在这卡住了？想去看看其他的教程吗？参阅 <a href="https://github.com/unifiedjs/.github/blob/main/support.md" target="_blank" rel="noreferrer">support.md</a></p></blockquote><h2 id="插件基础" tabindex="-1">插件基础 <a class="header-anchor" href="#插件基础" aria-label="Permalink to &quot;插件基础&quot;">​</a></h2><p><a href="https://unifiedjs.com/explore/package/unified/" target="_blank" rel="noreferrer">unified</a> 插件在几个方面改变了应用处理器(processor) 的工作方式。在这篇教程中，我们将检阅(review) 如何检查语法树。</p><p>插件包含两部分： attacher，一个被 <code>.use</code> 方法调用的函数；transformer，一个当每次文件被通过语法树和虚拟文件处理时调用的可选函数。</p><p>在这个案例中，我们想检查每个被处理文件的语法树，所以我们确实需要指定一个 transformer。</p><p>现在你知道了 <a href="https://unifiedjs.com/explore/package/unified/" target="_blank" rel="noreferrer">unified</a> 插件的基础组成。开始我们的案例吧！</p><h2 id="案例" tabindex="-1">案例 <a class="header-anchor" href="#案例" aria-label="Permalink to &quot;案例&quot;">​</a></h2><p>在开始之前，先明确我们需要实现什么样的效果。有以下的文本文件：</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki nord vp-code"><code><span class="line"><span>One sentence. Two sentences.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>One sentence.  Two sentences.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们想在第二段获得一个警告，说明句子之间应该用一个空格，而不是两个。</p><p>下一步，将编写代码来使用我们的插件。</p><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><p>让我们配置一个工程。创建文件夹 <code>example</code>，进入它，并创建一个新的工程。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">mkdir</span><span style="color:#A3BE8C;"> example</span></span>
<span class="line"><span style="color:#88C0D0;">cd</span><span style="color:#A3BE8C;"> example</span></span>
<span class="line"><span style="color:#88C0D0;">npm</span><span style="color:#A3BE8C;"> init</span><span style="color:#A3BE8C;"> -y</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后，确保这个工程是一个 module，以保证 <code>import</code> 和 <code>export</code> 的正常工作。通过修改 <code>package.json</code> 实现：</p><div class="language-diff line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">--- a/package.json</span></span>
<span class="line"><span style="color:#ECEFF4;">+++</span><span style="color:#D8DEE9FF;"> b/package.json</span></span>
<span class="line"><span style="color:#8FBCBB;">@@</span><span style="color:#D8DEE9FF;"> -2,6 +2,7 </span><span style="color:#8FBCBB;">@@</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   &quot;name&quot;: &quot;example&quot;,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   &quot;version&quot;: &quot;1.0.0&quot;,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   &quot;description&quot;: &quot;&quot;,</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">  &quot;type&quot;: &quot;module&quot;,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   &quot;main&quot;: &quot;index.js&quot;,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   &quot;scripts&quot;: {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     &quot;test&quot;: &quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>确保 <code>example.md</code> 文件存在，并且内容如下：</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki nord vp-code"><code><span class="line"><span>One sentence. Two sentences.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>One sentence.  Two sentences.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>现在，我们创建一个 <code>example.js</code> 文件，将用于处理我们的文本文件，并报告一些发现的问题.</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> fs</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">fs</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;">retext</span><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">retext</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> {</span><span style="color:#8FBCBB;">reporter</span><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">vfile-reporter</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> retextSentenceSpacing</span><span style="color:#81A1C1;"> from</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">./index.js</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">const</span><span style="color:#D8DEE9;"> buffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> fs</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">readFileSync</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">example.md</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">retext</span><span style="color:#D8DEE9FF;">()</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">use</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">retextSentenceSpacing</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">process</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">buffer</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  .</span><span style="color:#88C0D0;">then</span><span style="color:#D8DEE9FF;">(</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    console</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">error</span><span style="color:#D8DEE9FF;">(</span><span style="color:#88C0D0;">reporter</span><span style="color:#D8DEE9FF;">(</span><span style="color:#D8DEE9;">file</span><span style="color:#D8DEE9FF;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span><span style="color:#D8DEE9FF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><p>不要忘记去 <code>npm install</code> 依赖 (<code>retext</code>, <code>vfile-reporter</code>)！</p></blockquote><p>如果你阅读 <a href="https://unifiedjs.com/learn/guide/using-unified/" target="_blank" rel="noreferrer">使用 unified</a> 教程，将会发现一些类似的语句。首先，我们加载了依赖项，然后读取了文件。我们使用了将在第二步创建的插件对文件进行处理，最后报告一个致命错误，或者被发现的一些规范化消息。</p><p>注意我们直接依赖 <a href="https://unifiedjs.com/explore/project/retextjs/retext/" target="_blank" rel="noreferrer">retext</a>。这个包暴露了一个 <a href="https://unifiedjs.com/explore/package/unified/" target="_blank" rel="noreferrer">unified</a> 处理器，并附带了解析器(parser) 和编译器(compiler)。</p><p>当运行我们的示例之时（它现在还不能工作）我们希望看到第二段的一条消息，告诉应该用一个空格取代两个空格。</p><p>现在我们配置完成了除了插件本身的所有部分。我们将在下一章节进行实现。</p><h2 id="插件" tabindex="-1">插件 <a class="header-anchor" href="#插件" aria-label="Permalink to &quot;插件&quot;">​</a></h2><p>当我们阅读了插件基础的部分，我们知道了需要一个插件，并且我们的案例需要一个 transformer。让我们开始在插件文件 <code>index.js</code> 中创建他们吧：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">export</span><span style="color:#81A1C1;"> default</span><span style="color:#81A1C1;"> function</span><span style="color:#88C0D0;"> retextSentenceSpacing</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">  return</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">tree</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> file</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> =&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>首先要做的事情是，我们需要检查 <code>tree</code> 的数据样式。可以使用名为 <a href="https://unifiedjs.com/explore/package/unist-util-visit/" target="_blank" rel="noreferrer">unist-util-visit</a> 的工具帮助我们递归树结构。现在让我们添加它。</p><div class="language-diff line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">--- a/index.js</span></span>
<span class="line"><span style="color:#ECEFF4;">+++</span><span style="color:#D8DEE9FF;"> b/index.js</span></span>
<span class="line"><span style="color:#8FBCBB;">@@</span><span style="color:#D8DEE9FF;"> -1,4 +1,9 </span><span style="color:#8FBCBB;">@@</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">import {visit} from &#39;unist-util-visit&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> export default function retextSentenceSpacing() {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   return (tree, file) =&gt; {</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">    visit(tree, &#39;ParagraphNode&#39;, (node) =&gt; {</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">      console.log(node)</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">    })</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   }</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>不要忘了去 <code>npm install</code> 这个工具！</p></blockquote><p>如果我们现在使用 Node.js 运行我们的示例，正如下面展示的，将看见在我们的示例中的两个段落调用了观察者(visitor)：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">node</span><span style="color:#A3BE8C;"> expample.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki nord vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  type: &#39;ParagraphNode&#39;,</span></span>
<span class="line"><span>  children: [</span></span>
<span class="line"><span>    { type: &#39;SentenceNode&#39;, children: [Array], position: [Object] },</span></span>
<span class="line"><span>    { type: &#39;WhiteSpaceNode&#39;, value: &#39; &#39;, position: [Position] },</span></span>
<span class="line"><span>    { type: &#39;SentenceNode&#39;, children: [Array], position: [Object] }</span></span>
<span class="line"><span>  ],</span></span>
<span class="line"><span>  position: {</span></span>
<span class="line"><span>    start: { line: 1, column: 1, offset: 0 },</span></span>
<span class="line"><span>    end: { line: 1, column: 29, offset: 28 }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  type: &#39;ParagraphNode&#39;,</span></span>
<span class="line"><span>  children: [</span></span>
<span class="line"><span>    { type: &#39;SentenceNode&#39;, children: [Array], position: [Object] },</span></span>
<span class="line"><span>    { type: &#39;WhiteSpaceNode&#39;, value: &#39;  &#39;, position: [Position] },</span></span>
<span class="line"><span>    { type: &#39;SentenceNode&#39;, children: [Array], position: [Object] }</span></span>
<span class="line"><span>  ],</span></span>
<span class="line"><span>  position: {</span></span>
<span class="line"><span>    start: { line: 3, column: 1, offset: 30 },</span></span>
<span class="line"><span>    end: { line: 3, column: 30, offset: 59 }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>no issues found</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>输出内容展示了段落包含两种类型的节点(nodes)：<code>SentenceNode</code> 和 <code>WhiteSpaceNode</code>。后者是我们想要去检查的，但是前者是重要的，因为在这个插件中我们只想在句子之间的地方警告空白空格。（不过，这可能是另一个可以实现的插件）</p><p>现在循环每个段落的子节点。只检查句子之间的空白空格。我们使用一个小工具来检查节点的类型：<a href="https://unifiedjs.com/explore/package/unist-util-is/" target="_blank" rel="noreferrer"><code>unist-util-is/</code></a>。</p><div class="language-diff line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">--- a/index.js</span></span>
<span class="line"><span style="color:#ECEFF4;">+++</span><span style="color:#D8DEE9FF;"> b/index.js</span></span>
<span class="line"><span style="color:#8FBCBB;">@@</span><span style="color:#D8DEE9FF;"> -1,9 +1,20 </span><span style="color:#8FBCBB;">@@</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> import {visit} from &#39;unist-util-visit&#39;</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">import {is} from &#39;unist-util-is&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;"> export default function retextSentenceSpacing() {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   return (tree, file) =&gt; {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     visit(tree, &#39;ParagraphNode&#39;, (node) =&gt; {</span></span>
<span class="line"><span style="color:#ECEFF4;">-</span><span style="color:#BF616A;">      console.log(node)</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">      const children = node.children</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">      children.forEach((child, index) =&gt; {</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">        if (</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">          is(children[index - 1], &#39;SentenceNode&#39;) &amp;&amp;</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">          is(child, &#39;WhiteSpaceNode&#39;) &amp;&amp;</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">          is(children[index + 1], &#39;SentenceNode&#39;)</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">        ) {</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">          console.log(child)</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">      })</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     })</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   }</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><blockquote><p>不要忘记去 <code>npm install</code> 这个工具！</p></blockquote><p>如果现在运行我们的示例，我们将会看到仅句子之间的空白空格被记录。</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">node</span><span style="color:#A3BE8C;"> example.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki nord vp-code"><code><span class="line"><span>{</span></span>
<span class="line"><span>  type: &#39;WhiteSpaceNode&#39;,</span></span>
<span class="line"><span>  value: &#39; &#39;,</span></span>
<span class="line"><span>  position: Position {</span></span>
<span class="line"><span>    start: { line: 1, column: 14, offset: 13 },</span></span>
<span class="line"><span>    end: { line: 1, column: 15, offset: 14 }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  type: &#39;WhiteSpaceNode&#39;,</span></span>
<span class="line"><span>  value: &#39;  &#39;,</span></span>
<span class="line"><span>  position: Position {</span></span>
<span class="line"><span>    start: { line: 3, column: 14, offset: 43 },</span></span>
<span class="line"><span>    end: { line: 3, column: 16, offset: 45 }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>no issues found</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>最后，我们在为第二个空白空格添加警告，表示它实际拥有字符超过了所需的。我们使用 <a href="https://unifiedjs.com/explore/package/vfile/#vfilemessagereason-position-origin" target="_blank" rel="noreferrer"><code>file.message()</code></a> 方法将文件和消息联系在一起。</p><div class="language-diff line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">--- a/index.js</span></span>
<span class="line"><span style="color:#ECEFF4;">+++</span><span style="color:#D8DEE9FF;"> b/index.js</span></span>
<span class="line"><span style="color:#8FBCBB;">@@</span><span style="color:#D8DEE9FF;"> -12,7 +12,12 </span><span style="color:#8FBCBB;">@@</span><span style="color:#D8DEE9FF;"> export default function retextSentenceSpacing() {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">           is(child, &#39;WhiteSpaceNode&#39;) &amp;&amp;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">           is(children[index + 1], &#39;SentenceNode&#39;)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         ) {</span></span>
<span class="line"><span style="color:#ECEFF4;">-</span><span style="color:#BF616A;">          console.log(child)</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">          if (child.value.length !== 1) {</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">            file.message(</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">              &#39;Expected 1 space between sentences, not &#39; + child.value.length,</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">              child</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">            )</span></span>
<span class="line"><span style="color:#ECEFF4;">+</span><span style="color:#A3BE8C;">          }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">       })</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     })</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>如果我们现在最后一次运行示例，我们将看见问题的一条警告消息。</p><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki nord vp-code"><code><span class="line"><span>$ node example.js</span></span>
<span class="line"><span>3:14-3:16  warning  Expected 1 space between sentences, not 2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>⚠ 1 warning</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="进一步练习" tabindex="-1">进一步练习 <a class="header-anchor" href="#进一步练习" aria-label="Permalink to &quot;进一步练习&quot;">​</a></h2><p>在句子之间的一个空格并不适用于所有人。这个插件接收想要的空格数量，来替代硬编码 <code>1</code>。</p><p>如果你想要警告句子之间的缩进或者新行，也可以创建一个插件？</p><p>如果你还没准备好，可以看看 <a href="https://unifiedjs.com/learn/" target="_blank" rel="noreferrer">学习章节</a> 的其他文章。</p>`,51),r=[l];function o(c,i,t,b,u,d){return a(),n("div",null,r)}const y=s(p,[["render",o]]);export{E as __pageData,y as default};
